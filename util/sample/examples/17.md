#util/sample/examples/17
```js:js_input

const user = () => _state({
  t:           now(),
  state:       'idle', // assume awake _now_
  items:       0,
})
const events = {
  wake:   _if(sleeping, daily(within(9, 1)), x=>{ x.state='idle' }),
  sleep:  _if(awake, daily(within(2, 1)), x=>{ x.state='sleeping' }),
  create: _if(awake&&awake, randomly(3), inc('items')),
  delete: _if(awake, randomly(6), inc({ items:-1 })),
}

```
---
```js:js_input

const { items } = simulate(user, now() + 3, events)
predict(items)

```
```js:js_removed

const sleeping = x => x.state == 'sleeping'
const or = (...fxJ) => fxJ.some(fx=>fx(x))
const and = (...fxJ) => fxJ.every(fx=>fx(x))
const not = fx => x => !fx(x)
const awake = not(sleeping)

const _sample_options = {
  stats:'mks ess lwr r t',
  max_time:15000,
  table:true,
  plot:true,
  // size:1, // debug
  async:true,
  hist:{ values:100 } // allow more values to prevent truncation/sorting
  // workers:navigator.hardwareConcurrency,
}

// TODO: design mechanism to expand both state and processes, e.g. calories, weight, etc
// TODO: allow both inexact (e.g. calories) and exact (e.g. weight) observations (logged events)
//       allow specifying sampling domains in logged events using special syntax? (e.g. ~``)
//       focus on daily aggregates (allowing for missing events) instead of precise event times?
//       allow significant differences day-to-day, e.g. using per-day unknowns?
//       run _daily_ simulations, w/ unknowns constrained by daily logs? (and prior knowledge)
//       later run weekly, annual, etc, simulations constrained by lower sims and prior knowledge?
//
// NOTE: trouble with above is that it is extremely difficult to truly "condition" on logged events, and it highlights the need for sequential weight relaxation instead of any sort of likelihood computation; that should allow extremely sophisticated inference, but requires (1) simulation w/ plausible domain, and (2) domain/weight relexation function
//
// NOTE: more accurate model of eating would require considering models of location & special states (e.g. driving, working, watching tv, etc), w/ certain special locations (e.g. home, hockey, work, etc) triggering special behavior
//
// TODO: instead of figuring out how to decompose, try implementing a monolithic model/simulation first, adding variables such as location, activity, last_ate, etc, and designing conditional mutation events ...

// states
// sleeping
// working
// driving
// biking
// toilet
// idle


```
#_util #_async