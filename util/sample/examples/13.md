#util/sample/examples/13 Optimize [simulation](#util/sim) outcomes under constraints.
```js

const A = 4 // assets
const μA = [.05, .025, .005, .0125] // mean change (relative) per period
// const μA = [.04, .05, .05, .05] // <- 0 @q=.9, 1 @q=.8
// const μA = [.05, .05, .05, .05] // <- 0 @q>.7, 3 @q<.4
const σA = [.1, .05, .01, .025] // standard deviation in change per period
const dA = array(A, a=> μA[a]-.5*σA[a]**2)
const wA = array(A) // reused allocation array (parameter)
const portfolio = () => _state({ pA:ones(A), value:1 })
const reprice = _do(x=>{
  apply(x.pA, (x,a)=> x * exp(dA[a] + σA[a]*random_normal()))
  x.value = dot(x.pA, wA)
})

```
```js:js_input

const [crypto, stocks, bonds, reits] = sample_array(A, wA, summand(1))
confine(bonds + reits, above(.3))
const {value} = simulate(portfolio, 10, {reprice})
maximize(value)

```
```js:js_removed

const _sample_options = {
  context:{A},
  stats:'mks ess lwr r.0 r.x.value t ua.crypto median.x.value median.bonds median.reits',
  max_time: 10000,
  // max_time: 10000,
  // min_time: 9000, // to see degradation w/o reweights (if min_ess > 1-q)
  // opt_time: 3000,
  // min_ess: 900,
  table:true,
  plot:true,
  // log:true,
  // size:1, // debug
  async:true,
  // workers:navigator.hardwareConcurrency,
}

```
#_util #_async
